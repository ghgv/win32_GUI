#include "matrix.h"

float aaa[16] = {
   1, 0, 0, 0,
   0, 1, 0, 0,
   0, 0, 1, 0,
   0, 0, 0, 1
};

void Mul4x4(float a[16],float x,float y,float z,float w)
{
    int i;
    float c[16],b[16];

    b[0]=1-2*y*y-2*z*z;
    b[1]=2*x*y-2*w*z;
    b[2]=2*x*z+2*w*y;
    b[3]=0;
    b[4]=2*x*y+2*w*z;
    b[5]= 1-2*x*x-2*z*z;
    b[6]= 2*y*z-2*w*x;
    b[7]=0;
    b[8]=2*x*z-2*w*y;
    b[9]=2*y*z+2*w*x;
    b[10]=1-2*x*x-2*y*y;
    b[11]=0;
    b[12]=0;
    b[13]=0;
    b[14]=0;
    b[15]=1;

    c[0]=a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+ a[3]*b[12];
    c[1]=a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+ a[3]*b[13];
    c[2]=a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14];
    c[3]=a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15];

    c[4]=a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12];
    c[5]=a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13];
    c[6]=a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14];
    c[7]=a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*b[15];

    c[8]=a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12];
    c[9]=a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13];
    c[10]=a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14];
    c[11]=a[8]*b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15];

    c[12]=a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12];
    c[13]=a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13];
    c[14]=a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14];
    c[15]=a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15];

    for (i=0;i<16;i++)
        a[i]=c[i];
    /* printf(" %f %f %f %f \n",c[0],c[1],c[2],c[3]);
     printf(" %f %f %f %f \n",c[4],c[5],c[6],c[7]);
     printf(" %f %f %f %f \n",c[8],c[9],c[10],c[11]);
     printf(" %f %f %f %f \n",c[12],c[13],c[14],c[15]);*/
}

